var Handlebars=function(){var a=function(){"use strict";function a(a){this.string=a}var b;return a.prototype.toString=function(){return""+this.string},b=a}(),b=function(a){"use strict";function b(a){return h[a]||"&amp;"}function c(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])}function d(a){return a instanceof g?a.toString():a||0===a?(a=""+a,j.test(a)?a.replace(i,b):a):""}function e(a){return a||0===a?m(a)&&0===a.length?!0:!1:!0}var f={},g=a,h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=/[&<>"'`]/g,j=/[&<>"'`]/;f.extend=c;var k=Object.prototype.toString;f.toString=k;var l=function(a){return"function"==typeof a};l(/x/)&&(l=function(a){return"function"==typeof a&&"[object Function]"===k.call(a)});var l;f.isFunction=l;var m=Array.isArray||function(a){return a&&"object"==typeof a?"[object Array]"===k.call(a):!1};return f.isArray=m,f.escapeExpression=d,f.isEmpty=e,f}(a),c=function(){"use strict";function a(a,b){var d;b&&b.firstLine&&(d=b.firstLine,a+=" - "+d+":"+b.firstColumn);for(var e=Error.prototype.constructor.call(this,a),f=0;f<c.length;f++)this[c[f]]=e[c[f]];d&&(this.lineNumber=d,this.column=b.firstColumn)}var b,c=["description","fileName","lineNumber","message","name","number","stack"];return a.prototype=new Error,b=a}(),d=function(a,b){"use strict";function c(a,b){this.helpers=a||{},this.partials=b||{},d(this)}function d(a){a.registerHelper("helperMissing",function(a){if(2===arguments.length)return void 0;throw new h("Missing helper: '"+a+"'")}),a.registerHelper("blockHelperMissing",function(b,c){var d=c.inverse||function(){},e=c.fn;return m(b)&&(b=b.call(this)),b===!0?e(this):b===!1||null==b?d(this):l(b)?b.length>0?a.helpers.each(b,c):d(this):e(b)}),a.registerHelper("each",function(a,b){var c,d=b.fn,e=b.inverse,f=0,g="";if(m(a)&&(a=a.call(this)),b.data&&(c=q(b.data)),a&&"object"==typeof a)if(l(a))for(var h=a.length;h>f;f++)c&&(c.index=f,c.first=0===f,c.last=f===a.length-1),g+=d(a[f],{data:c});else for(var i in a)a.hasOwnProperty(i)&&(c&&(c.key=i,c.index=f,c.first=0===f),g+=d(a[i],{data:c}),f++);return 0===f&&(g=e(this)),g}),a.registerHelper("if",function(a,b){return m(a)&&(a=a.call(this)),!b.hash.includeZero&&!a||g.isEmpty(a)?b.inverse(this):b.fn(this)}),a.registerHelper("unless",function(b,c){return a.helpers["if"].call(this,b,{fn:c.inverse,inverse:c.fn,hash:c.hash})}),a.registerHelper("with",function(a,b){return m(a)&&(a=a.call(this)),g.isEmpty(a)?void 0:b.fn(a)}),a.registerHelper("log",function(b,c){var d=c.data&&null!=c.data.level?parseInt(c.data.level,10):1;a.log(d,b)})}function e(a,b){p.log(a,b)}var f={},g=a,h=b,i="1.3.0";f.VERSION=i;var j=4;f.COMPILER_REVISION=j;var k={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};f.REVISION_CHANGES=k;var l=g.isArray,m=g.isFunction,n=g.toString,o="[object Object]";f.HandlebarsEnvironment=c,c.prototype={constructor:c,logger:p,log:e,registerHelper:function(a,b,c){if(n.call(a)===o){if(c||b)throw new h("Arg not supported with multiple helpers");g.extend(this.helpers,a)}else c&&(b.not=c),this.helpers[a]=b},registerPartial:function(a,b){n.call(a)===o?g.extend(this.partials,a):this.partials[a]=b}};var p={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(a,b){if(p.level<=a){var c=p.methodMap[a];"undefined"!=typeof console&&console[c]&&console[c].call(console,b)}}};f.logger=p,f.log=e;var q=function(a){var b={};return g.extend(b,a),b};return f.createFrame=q,f}(b,c),e=function(a,b,c){"use strict";function d(a){var b=a&&a[0]||1,c=m;if(b!==c){if(c>b){var d=n[c],e=n[b];throw new l("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+d+") or downgrade your runtime to an older version ("+e+").")}throw new l("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+").")}}function e(a,b){if(!b)throw new l("No environment passed to template");var c=function(a,c,d,e,f,g){var h=b.VM.invokePartial.apply(this,arguments);if(null!=h)return h;if(b.compile){var i={helpers:e,partials:f,data:g};return f[c]=b.compile(a,{data:void 0!==g},b),f[c](d,i)}throw new l("The partial "+c+" could not be compiled when running in runtime-only mode")},d={escapeExpression:k.escapeExpression,invokePartial:c,programs:[],program:function(a,b,c){var d=this.programs[a];return c?d=g(a,b,c):d||(d=this.programs[a]=g(a,b)),d},merge:function(a,b){var c=a||b;return a&&b&&a!==b&&(c={},k.extend(c,b),k.extend(c,a)),c},programWithDepth:b.VM.programWithDepth,noop:b.VM.noop,compilerInfo:null};return function(c,e){e=e||{};var f,g,h=e.partial?e:b;e.partial||(f=e.helpers,g=e.partials);var i=a.call(d,h,c,f,g,e.data);return e.partial||b.VM.checkRevision(d.compilerInfo),i}}function f(a,b,c){var d=Array.prototype.slice.call(arguments,3),e=function(a,e){return e=e||{},b.apply(this,[a,e.data||c].concat(d))};return e.program=a,e.depth=d.length,e}function g(a,b,c){var d=function(a,d){return d=d||{},b(a,d.data||c)};return d.program=a,d.depth=0,d}function h(a,b,c,d,e,f){var g={partial:!0,helpers:d,partials:e,data:f};if(void 0===a)throw new l("The partial "+b+" could not be found");return a instanceof Function?a(c,g):void 0}function i(){return""}var j={},k=a,l=b,m=c.COMPILER_REVISION,n=c.REVISION_CHANGES;return j.checkRevision=d,j.template=e,j.programWithDepth=f,j.program=g,j.invokePartial=h,j.noop=i,j}(b,c,d),f=function(a,b,c,d,e){"use strict";var f,g=a,h=b,i=c,j=d,k=e,l=function(){var a=new g.HandlebarsEnvironment;return j.extend(a,g),a.SafeString=h,a.Exception=i,a.Utils=j,a.VM=k,a.template=function(b){return k.template(b,a)},a},m=l();return m.create=l,f=m}(d,a,c,b,e);return f}();this.kwps_admin_templates=this.kwps_admin_templates||{},this.kwps_admin_templates.choose_testmodus=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n		<li>\n			<input type="radio" value="',(e=c.ID)?d=e.call(a,{hash:{},data:b}):(e=a&&a.ID,d=typeof e===i?e.call(a,{hash:{},data:b}):e),f+=j(d)+'" name="post_parent" id="kwpsTestModi_',(e=c.ID)?d=e.call(a,{hash:{},data:b}):(e=a&&a.ID,d=typeof e===i?e.call(a,{hash:{},data:b}):e),f+=j(d)+'"><label\n				for="kwpsTestModi_',(e=c.ID)?d=e.call(a,{hash:{},data:b}):(e=a&&a.ID,d=typeof e===i?e.call(a,{hash:{},data:b}):e),f+=j(d)+'">',(e=c.post_title)?d=e.call(a,{hash:{},data:b}):(e=a&&a.post_title,d=typeof e===i?e.call(a,{hash:{},data:b}):e),f+=j(d)+"</label>\n		</li>\n		"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h="",i="function",j=this.escapeExpression,k=this;return h+='<form id="create-new-test">\n	<label>Test name</label>\n	<input name="post_title">\n	<ul>\n		',g=c.each.call(b,b&&b.kwpsTestModi,{hash:{},inverse:k.noop,fn:k.program(1,f,e),data:e}),(g||0===g)&&(h+=g),h+='\n	</ul>\n	<div>\n		<button type="submit">Create</button>\n	</div>\n</form>\n'}),this.kwps_admin_templates.control_panel=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),d=this.merge(d,a.partials),e=e||{};var f,g="",h=this;return g+='<div id="icon-tests" class="icon32"><br/>\n</div>\n<h2>Test control panel</h2>\n\n<div class="test-input">\n    <input type="text" name="post_title" id="post_title" value="Wa tekst" placeholder="<?php _e( \'New Test\' ) ?>"/>\n</div>\n\n<div id="tabs">\n    <ul>\n        <li><a href="#tabs-add">Test builder</a></li>\n        <li><a href="#tabs-results">Control results</a></li>\n        <li><a href="#tabs-entries">Manage entries</a></li>\n        <li><a href="#tabs-settings">Settings</a></li>\n    </ul>\n    <div id="tabs-add">\n        ',f=h.invokePartial(d.controlTest,"controlTest",b,c,d,e),(f||0===f)&&(g+=f),g+='\n    </div>\n    <div id="tabs-results">\n        ',f=h.invokePartial(d.controlResults,"controlResults",b,c,d,e),(f||0===f)&&(g+=f),g+='\n    </div>\n    <div id="tabs-entries">\n        ',f=h.invokePartial(d.manageEntries,"manageEntries",b,c,d,e),(f||0===f)&&(g+=f),g+='\n    </div>\n    <div id="tabs-settings">\n        ',f=h.invokePartial(d.settings,"settings",b,c,d,e),(f||0===f)&&(g+=f),g+="\n    </div>\n</div>"}),this.kwps_admin_templates.control_results=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},"<p>Morbi tincidunt, dui sit amet facilisis feugiat, odio metus gravida ante, ut pharetra massa metus id\n            nunc. Duis scelerisque molestie turpis. Sed fringilla, massa eget luctus malesuada, metus eros molestie\n            lectus, ut tempus eros massa ut dolor. Aenean aliquet fringilla sem. Suspendisse sed ligula in ligula\n            suscipit aliquam. Praesent in eros vestibulum mi adipiscing adipiscing. Morbi facilisis. Curabitur\n            ornare consequat nunc. Aenean vel metus. Ut posuere viverra nulla. Aliquam erat volutpat. Pellentesque\n            convallis. Maecenas feugiat, tellus pellentesque pretium posuere, felis lorem euismod felis, eu ornare\n            leo nisi vel felis. Mauris consectetur tortor et purus.</p>"}),this.kwps_admin_templates.control_test=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+="\n                ",d=c["if"].call(a,a&&a.mainTitle,{hash:{},inverse:o.noop,fn:o.program(2,g,b),data:b}),(d||0===d)&&(e+=d),e+="\n                ",d=c["if"].call(a,a&&a.mainRow,{hash:{},inverse:o.noop,fn:o.program(4,h,b),data:b}),(d||0===d)&&(e+=d),e+="\n                ",d=c["if"].call(a,a&&a.questionTitle,{hash:{},inverse:o.noop,fn:o.program(6,i,b),data:b}),(d||0===d)&&(e+=d),e+="\n                ",d=c["if"].call(a,a&&a.question,{hash:{},inverse:o.noop,fn:o.program(8,j,b),data:b}),(d||0===d)&&(e+=d),e+="\n                ",d=c["if"].call(a,a&&a.answerTitle,{hash:{},inverse:o.noop,fn:o.program(10,k,b),data:b}),(d||0===d)&&(e+=d),e+="\n                ",d=c["if"].call(a,a&&a.answer,{hash:{},inverse:o.noop,fn:o.program(12,l,b),data:b}),(d||0===d)&&(e+=d),e+="\n            "}function g(a,b){var e,f="";return f+="\n                    ",e=o.invokePartial(d.controlTestMainTitleRow,"controlTestMainTitleRow",a,c,d,b),(e||0===e)&&(f+=e),f+="\n                "}function h(a,b){var e,f="";return f+="\n                    ",e=o.invokePartial(d.controlTestMainRow,"controlTestMainRow",a,c,d,b),(e||0===e)&&(f+=e),f+="\n                "}function i(a,b){var e,f="";return f+="\n                    ",e=o.invokePartial(d.controlTestQuestionTitleRow,"controlTestQuestionTitleRow",a,c,d,b),(e||0===e)&&(f+=e),f+="\n                "}function j(a,b){var e,f="";return f+="\n                    ",e=o.invokePartial(d.controlTestQuestionRow,"controlTestQuestionRow",a,c,d,b),(e||0===e)&&(f+=e),f+="\n                "}function k(a,b){var e,f="";return f+="\n                    ",e=o.invokePartial(d.controlTestAnswerTitleRow,"controlTestAnswerTitleRow",a,c,d,b),(e||0===e)&&(f+=e),f+="\n                "}function l(a,b){var e,f="";return f+="\n                    ",e=o.invokePartial(d.controlTestAnswerRow,"controlTestAnswerRow",a,c,d,b),(e||0===e)&&(f+=e),f+="\n                "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),d=this.merge(d,a.partials),e=e||{};var m,n="",o=this;return n+='<div>\n    <div>\n        <table id="matrix" class="wp-list-table widefat fixed" style="table-layout:fixed;">\n            \n\n            ',m=o.invokePartial(d.controlTestTopRow,"controlTestTopRow",b,c,d,e),(m||0===m)&&(n+=m),n+="\n            ",m=c.each.call(b,b&&b.table,{hash:{},inverse:o.noop,fn:o.program(1,f,e),data:e}),(m||0===m)&&(n+=m),n+="\n        </table>\n    </div>\n</div>"}),this.kwps_admin_templates.control_test_answer_row=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<tr class="post-1 type-post status-publish format-standard hentry category-uncategorized iedit author-self level-0" style="background:#FFF8E7">\n    <td class="column-action" style="border: none; padding: 0px;height: 60px;">\n        <div style="width:30px; height: 60px; float:left;">\n            <svg x="0px" y="0px" viewBox="0 0 30 60">\n                <rect x="0" y="0" fill="#FFFFFF" width="20" height="60"></rect>\n                <rect x="20" y="0" fill="#FFBA00" width="10" height="60"></rect>\n            </svg>\n        </div>\n        <div class="move">\n            <span class="up passive"></span>\n            <span class="down"></span>\n        </div>\n        <div class="action" style="padding: 10px; float:left;">\n            <a class="delete-intro">\n                <span class="del" data-post-type="kwps_intro">\n                    <span data-code="f182" class="dashicons dashicons-trash"></span>\n                </span>\n            </a>\n            1\n        </div>\n    </td>\n    <td id="_kwps_answer_option_',(g=c.ID)?f=g.call(b,{hash:{},data:e}):(g=b&&b.ID,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" class="post-title page-title column-title">\n        <strong>\n            <a class="row-title" href="#edit/'+k((f=b&&b.kwpsIntro,f=null==f||f===!1?f:f.ID,typeof f===j?f.apply(b):f))+'"\n               title="'+k((g=c.t||b&&b.t,h={hash:{},data:e},g?g.call(b,"Edit",h):l.call(b,"t","Edit",h)))+'">mldfkqùdsfgjlmùdsfgùmfdkg</a>\n        </strong>\n\n        <div class="actions" style="display: none"><a href="#edit/'+k((f=b&&b.kwpsIntro,f=null==f||f===!1?f:f.ID,typeof f===j?f.apply(b):f))+'">edit</a></div>\n    </td>\n    <td id="_kwps_intro_nog_iets_',(g=c.ID)?f=g.call(b,{hash:{},data:e}):(g=b&&b.ID,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" class="post-title page-title column-title">\n        &nbsp;\n    </td>\n</tr>'}),this.kwps_admin_templates.control_test_answer_title_row=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<tr class="post-1 type-post title status-publish format-standard hentry category-uncategorized iedit author-self level-0" style="background:#FFB500">\n                <th class="no-delete row-title" colspan="',(g=c.colSpan)?f=g.call(b,{hash:{},data:e}):(g=b&&b.colSpan,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" style=" border-top: #FFBA00; padding: 0px;height: 42px;">\n                    <div style="width:20px; height: 42px; float:left;">\n                        <svg x="0px" y="0px" viewBox="0 0 20 42">\n                            <rect x="0" y="0" fill="#FFFFFF" width="10" height="42"></rect>\n                            <rect x="10" y="0" fill="#1E8CBE" width="10" height="42"></rect>\n                        </svg>\n                    </div>\n                    <div style="padding: 10px; float:left;">\n                        '+k((g=c.t||b&&b.t,h={hash:{},data:e},g?g.call(b,b&&b.title,h):l.call(b,"t",b&&b.title,h)))+'\n                        <button class="button add" data-post-type="',(g=c.postType)?f=g.call(b,{hash:{},data:e}):(g=b&&b.postType,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'">\n                            <span data-code="f132" class="dashicons dashicons-plus"></span>\n                            '+k((g=c.t||b&&b.t,h={hash:{},data:e},g?g.call(b,b&&b.addText,h):l.call(b,"t",b&&b.addText,h)))+'\n                        </button>\n                    </div> \n                </th>\n                <th class="no-delete row-title" style="height:20px;">3</th>\n            </tr>'}),this.kwps_admin_templates.control_test_main_row=Handlebars.template(function(a,b,c,d,e){function f(){return'\n        <div class="move">\n            <span class="up passive"></span>\n            <span class="down"></span>\n        </div>\n        '}function g(a,b){var d,e="";return e+="\n                ",d=c["if"].call(a,a&&a.hasOpened,{hash:{},inverse:q.program(6,i,b),fn:q.program(4,h,b),data:b}),(d||0===d)&&(e+=d),e+="\n            "}function h(a,b){var c,d="";return d+='\n                    <span data-code="f140" class="dashicons dashicons-arrow-down toggle-details" data-type="question" data-question-row="'+p((c=null==b||b===!1?b:b.index,typeof c===o?c.apply(a):c))+'"></span>\n                '}function i(a,b){var c,d="";return d+='\n                    <span data-code="f140" class="dashicons dashicons-arrow-right toggle-details" data-type="question" data-question-row="'+p((c=null==b||b===!1?b:b.index,typeof c===o?c.apply(a):c))+'"></span>\n                '}function j(a,b){var d,e,f="";return f+='\n            <a class="delete-intro">\n                <span class="del" data-post-type="',(e=c.postType)?d=e.call(a,{hash:{},data:b}):(e=a&&a.postType,d=typeof e===o?e.call(a,{hash:{},data:b}):e),f+=p(d)+'" data-type="row" data-sort-order="',(e=c.sortOrder)?d=e.call(a,{hash:{},data:b}):(e=a&&a.sortOrder,d=typeof e===o?e.call(a,{hash:{},data:b}):e),f+=p(d)+'">\n                    <span data-code="f182" class="dashicons dashicons-trash"></span>\n                </span>\n            </a>\n            '}function k(a,b){var d,e,f="";return f+='\n        <td id="_kwps_intro_',(e=c.ID)?d=e.call(a,{hash:{},data:b}):(e=a&&a.ID,d=typeof e===o?e.call(a,{hash:{},data:b}):e),f+=p(d)+'" class="post-title page-title column-title">\n            <strong>\n                <a class="row-title" href="#edit/',(e=c.ID)?d=e.call(a,{hash:{},data:b}):(e=a&&a.ID,d=typeof e===o?e.call(a,{hash:{},data:b}):e),f+=p(d)+'"\n                   title="Edit “”">',(e=c.post_content)?d=e.call(a,{hash:{},data:b}):(e=a&&a.post_content,d=typeof e===o?e.call(a,{hash:{},data:b}):e),f+=p(d)+'</a>\n            </strong>\n\n            <div class="actions" style="display: none"><a href="#edit/',(e=c.ID)?d=e.call(a,{hash:{},data:b}):(e=a&&a.ID,d=typeof e===o?e.call(a,{hash:{},data:b}):e),f+=p(d)+'">edit</a></div>\n        </td>\n    '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var l,m,n="",o="function",p=this.escapeExpression,q=this;return n+='\n<tr class="type-post status-publish format-standard hentry category-uncategorized iedit author-self level-0">\n    <td class="column-action" style="border: none; padding: 0px;height: 60px;">\n        <div style="width:10px; height: 60px; float:left;">\n            <svg x="0px" y="0px" viewBox="0 0 10 60">\n                <rect x="0" y="0" fill="#555555" width="10" height="60"></rect>\n            </svg>\n        </div>\n        ',l=c["if"].call(b,b&&b.sorterArrows,{hash:{},inverse:q.noop,fn:q.program(1,f,e),data:e}),(l||0===l)&&(n+=l),n+='\n        <div class="action" style="padding: 10px; float:left;">\n            ',l=c["if"].call(b,b&&b.hasMore,{hash:{},inverse:q.noop,fn:q.program(3,g,e),data:e}),(l||0===l)&&(n+=l),n+="\n            ",l=c["if"].call(b,b&&b.deletable,{hash:{},inverse:q.noop,fn:q.program(8,j,e),data:e}),(l||0===l)&&(n+=l),n+="\n        </div>\n    </td>\n    ",l=c.each.call(b,b&&b.versions,{hash:{},inverse:q.noop,fn:q.program(10,k,e),data:e}),(l||0===l)&&(n+=l),n+="\n    \n    <td>",(m=c.amountOfSiblings)?l=m.call(b,{hash:{},data:e}):(m=b&&b.amountOfSiblings,l=typeof m===o?m.call(b,{hash:{},data:e}):m),n+=p(l)+"</td>\n</tr>"}),this.kwps_admin_templates.control_test_main_title_row=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+="\n        	",d=c["if"].call(a,a&&a.opened,{hash:{},inverse:p.program(4,h,b),fn:p.program(2,g,b),data:b}),(d||0===d)&&(e+=d),e+="\n        "}function g(a,b){var d,e,f="";return f+='\n            	<span class="dashicons dashicons-arrow-down toggle-details" data-type="',(e=c.postType)?d=e.call(a,{hash:{},data:b}):(e=a&&a.postType,d=typeof e===n?e.call(a,{hash:{},data:b}):e),f+=o(d)+'"></span>\n        	'}function h(a,b){var d,e,f="";return f+='\n            	<span class="dashicons dashicons-arrow-right toggle-details" data-type="',(e=c.postType)?d=e.call(a,{hash:{},data:b}):(e=a&&a.postType,d=typeof e===n?e.call(a,{hash:{},data:b}):e),f+=o(d)+'" ></span>\n        	'}function i(a,b){var d,e,f,g="";return g+='\n        <button class="button add" data-post-type="',(e=c.postType)?d=e.call(a,{hash:{},data:b}):(e=a&&a.postType,d=typeof e===n?e.call(a,{hash:{},data:b}):e),g+=o(d)+'">\n            <span data-code="f132" class="dashicons dashicons-plus"></span>'+o((e=c.t||a&&a.t,f={hash:{},data:b},e?e.call(a,a&&a.addText,f):q.call(a,"t",a&&a.addText,f)))+"\n        </button>\n        "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var j,k,l,m="",n="function",o=this.escapeExpression,p=this,q=c.helperMissing;return m+='<tr class="title">\n    <th class="row-title" colspan="',(k=c.colSpan)?j=k.call(b,{hash:{},data:e}):(k=b&&b.colSpan,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+'">\n        ',j=c["if"].call(b,b&&b.hasMore,{hash:{},inverse:p.noop,fn:p.program(1,f,e),data:e}),(j||0===j)&&(m+=j),m+="\n        "+o((k=c.t||b&&b.t,l={hash:{},data:e},k?k.call(b,b&&b.title,l):q.call(b,"t",b&&b.title,l)))+"\n        ",j=c["if"].call(b,b&&b.add,{hash:{},inverse:p.noop,fn:p.program(6,i,e),data:e}),(j||0===j)&&(m+=j),m+='\n    </th>\n    <th class="row-title">',(k=c.amount)?j=k.call(b,{hash:{},data:e}):(k=b&&b.amount,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+"</th>\n</tr>"}),this.kwps_admin_templates.control_test_question_row=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n                <td id="_kwps_intro_',(e=c.ID)?d=e.call(a,{hash:{},data:b}):(e=a&&a.ID,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+'" class="post-title page-title column-title">\n                    <strong>\n                        <a class="row-title" href="#edit/',(e=c.ID)?d=e.call(a,{hash:{},data:b}):(e=a&&a.ID,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+'"\n                           title="Edit “',(e=c.post_content)?d=e.call(a,{hash:{},data:b}):(e=a&&a.post_content,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+'”">',(e=c.post_content)?d=e.call(a,{hash:{},data:b}):(e=a&&a.post_content,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+'</a>\n                    </strong>\n\n                    <div class="actions" style="display: none"><a href="#edit/',(e=c.ID)?d=e.call(a,{hash:{},data:b}):(e=a&&a.ID,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+'">edit</a></div>\n                </td>\n                '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i="",j="function",k=this.escapeExpression,l=this;return i+='<tr class="post-1 type-post status-publish format-standard hentry category-uncategorized iedit author-self level-0" style="background: #DAEFF8;">\n                <td class="column-action" style="border: none; padding: 0px;height: 60px;">\n                    <div style="width:20px; height: 60px; float:left;">\n                        <svg x="0px" y="0px" viewBox="0 0 20 60">\n                            <rect x="0" y="0" fill="#FFFFFF" width="10" height="60"></rect>\n                            <rect x="10" y="0" fill="#1E8CBE" width="10" height="60"></rect>\n                        </svg>\n                    </div>\n                    <div class="move">\n                        <span class="up passive"></span>\n                        <span class="down"></span>\n                    </div>\n                    <div class="action" style="padding: 10px; float:left;">\n                        <span data-code="f140" class="dashicons dashicons-arrow-down toggle-details" data-type="question" data-question-row="',(h=c.sortOrder)?g=h.call(b,{hash:{},data:e}):(h=b&&b.sortOrder,g=typeof h===j?h.call(b,{hash:{},data:e}):h),i+=k(g)+'"></span>\n\n                        <a class="delete-intro">\n                            <span class="del" data-post-type="kwps_qsdlfkj">\n                                <span data-code="f182" class="dashicons dashicons-trash"></span>\n                            </span>\n                        </a>\n                        ',(h=c.sortOrder)?g=h.call(b,{hash:{},data:e}):(h=b&&b.sortOrder,g=typeof h===j?h.call(b,{hash:{},data:e}):h),i+=k(g)+"\n                    </div>\n                    \n                </td>\n                ",g=c.each.call(b,b&&b.versions,{hash:{},inverse:l.noop,fn:l.program(1,f,e),data:e}),(g||0===g)&&(i+=g),i+="\n                <td>",(h=c.amountOfSiblings)?g=h.call(b,{hash:{},data:e}):(h=b&&b.amountOfSiblings,g=typeof h===j?h.call(b,{hash:{},data:e}):h),i+=k(g)+"</td>\n            </tr>\n            "}),this.kwps_admin_templates.control_test_question_title_row=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+=' <tr class="post-1 type-post title status-publish format-standard hentry category-uncategorized iedit author-self level-0" style="background: #1E8CBE;">\n    <th class="no-delete row-title" colspan="',(g=c.colSpan)?f=g.call(b,{hash:{},data:e}):(g=b&&b.colSpan,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" style="border-top: none ;padding: 0px;height: 40px;">\n        <div style="width:10px; height: 42px; float:left;">\n            <svg x="0px" y="0px" viewBox="0 0 10 42">\n                 <rect x="0" y="0" fill="#555555" width="10" height="42"></rect>\n            </svg>\n        </div>\n        <div style="padding: 10px; float:left; color:white;">\n            '+k((g=c.t||b&&b.t,h={hash:{},data:e},g?g.call(b,b&&b.title,h):l.call(b,"t",b&&b.title,h)))+'\n            <button class="button add" data-post-type="',(g=c.postType)?f=g.call(b,{hash:{},data:e}):(g=b&&b.postType,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'">\n                <span data-code="f132" class="dashicons dashicons-plus"></span>\n                '+k((g=c.t||b&&b.t,h={hash:{},data:e},g?g.call(b,b&&b.addText,h):l.call(b,"t",b&&b.addText,h)))+'\n            </button>\n        </div>  \n    </th>\n    <th class="no-delete row-title" style="height:20px; border-top: none;"></th>\n</tr>'}),this.kwps_admin_templates.control_test_top_row=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n        <th class=" column-title">\n            <div class="column-tab">\n                <input name="',(e=c.ID)?d=e.call(a,{hash:{},data:b}):(e=a&&a.ID,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+'" value="',(e=c.post_title)?d=e.call(a,{hash:{},data:b}):(e=a&&a.post_title,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+'">\n                ',d=c["if"].call(a,a&&a.deleteVersion,{hash:{},inverse:l.noop,fn:l.program(2,g,b),data:b}),(d||0===d)&&(f+=d),f+="\n            </div>\n        </th>\n    "}function g(a,b){var d,e,f="";return f+='\n                    <span class="del" data-post-type="kwps_version" data-type="row" data-sort-order="',(e=c._kwps_sort_order)?d=e.call(a,{hash:{},data:b}):(e=a&&a._kwps_sort_order,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+'">\n                        <span data-code="f182" class="dashicons dashicons-trash"></span>\n                    </span>\n                '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i="",j="function",k=this.escapeExpression,l=this;return i+='<tr>\n    <th class="no-delete column-action">&nbsp;</th>\n    ',h=c.each.call(b,b&&b.versions,{hash:{},inverse:l.noop,fn:l.program(1,f,e),data:e}),(h||0===h)&&(i+=h),i+='\n    <td class="column-title" style="width:85px;">\n        <div class="column-tab">\n            <button class="add button" data-post-type="kwps_version">\n                <span data-code="f132" class="dashicons dashicons-plus"></span>\n            </button>\n        </div>\n    </td>\n</tr>'}),this.kwps_admin_templates.edit=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n            <div>Title: <input type="text" name="qg-title" id="kwps-question-group-title" value="',(e=c.title)?d=e.call(a,{hash:{},data:b}):(e=a&&a.title,d=typeof e===l?e.call(a,{hash:{},data:b}):e),f+=m(d)+'"></div>\n        '}function g(a,b){var d,e,f="";return f+='\n            <div>Value: <input type="text" name="ao-value" id="kwps-answer-option-value" value="',(e=c.answer_option_value)?d=e.call(a,{hash:{},data:b}):(e=a&&a.answer_option_value,d=typeof e===l?e.call(a,{hash:{},data:b}):e),f+=m(d)+'"></div>\n        '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j,k="",l="function",m=this.escapeExpression,n=this,o=c.helperMissing;return k+="<h2>",(i=c.label)?h=i.call(b,{hash:{},data:e}):(i=b&&b.label,h=typeof i===l?i.call(b,{hash:{},data:e}):i),k+=m(h)+'</h2>\n<div>  \n	<form id="update-model">\n        ',h=c["if"].call(b,b&&b.title,{hash:{},inverse:n.noop,fn:n.program(1,f,e),data:e}),(h||0===h)&&(k+=h),k+="\n\n        ",h=c["if"].call(b,b&&b.answer_option_value,{hash:{},inverse:n.noop,fn:n.program(3,g,e),data:e}),(h||0===h)&&(k+=h),k+='\n        <br>\n        <button id="add-media-button"><span class="add-media-icon"></span>'+m((i=c.t||b&&b.t,j={hash:{},data:e},i?i.call(b,"Add medie",j):o.call(b,"t","Add medie",j)))+'</button>\n        <div id="editor-tiny">   \n		 <textarea name=\'text\' rows="20">',(i=c.text)?h=i.call(b,{hash:{},data:e}):(i=b&&b.text,h=typeof i===l?i.call(b,{hash:{},data:e}):i),k+=m(h)+'</textarea>\n        </div>\n		<button id="update">'+m((i=c.t||b&&b.t,j={hash:{},data:e},i?i.call(b,"update",j):o.call(b,"t","update",j)))+"</button>\n	</form>\n</div>"}),this.kwps_admin_templates.manage_entries=Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},"<p>EEEEE Morbi tincidunt, dui sit amet facilisis feugiat, odio metus gravida ante, ut pharetra massa metus\n                id nunc. Duis scelerisque molestie turpis. Sed fringilla, massa eget luctus malesuada, metus eros\n                molestie lectus, ut tempus eros massa ut dolor. Aenean aliquet fringilla sem. Suspendisse sed ligula in\n                ligula suscipit aliquam. Praesent in eros vestibulum mi adipiscing adipiscing. Morbi facilisis.\n                Curabitur ornare consequat nunc. Aenean vel metus. Ut posuere viverra nulla. Aliquam erat volutpat.\n                Pellentesque convallis. Maecenas feugiat, tellus pellentesque pretium posuere, felis lorem euismod\n                felis, eu ornare leo nisi vel felis. Mauris consectetur tortor et purus.</p>"}),this.kwps_admin_templates.nogietanders=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return(g=c.dot)?f=g.call(b,{hash:{},data:e}):(g=b&&b.dot,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"\ndiv ver ",(g=c.lkjd)?f=g.call(b,{hash:{},data:e}):(g=b&&b.lkjd,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)}),this.kwps_admin_templates.settings=Handlebars.template(function(a,b,c,d,e){function f(a,b,d){var e,f,g,h="";return h+='\n            <option value="',(f=c["function"])?e=f.call(a,{hash:{},data:b}):(f=a&&a["function"],e=typeof f===j?f.call(a,{hash:{},data:b}):f),h+=k(e)+'"\n            '+k((f=c.selected||a&&a.selected,g={hash:{},data:b},f?f.call(a,a&&a["function"],(e=d&&d.collection,null==e||e===!1?e:e._kwps_logged_in_user_limit),g):l.call(a,"selected",a&&a["function"],(e=d&&d.collection,null==e||e===!1?e:e._kwps_logged_in_user_limit),g)))+" >",(f=c.label)?e=f.call(a,{hash:{},data:b}):(f=a&&a.label,e=typeof f===j?f.call(a,{hash:{},data:b}):f),h+=k(e)+"</option>\n            "}function g(a,b,d){var e,f,g,h="";return h+='\n            <option value="',(f=c["function"])?e=f.call(a,{hash:{},data:b}):(f=a&&a["function"],e=typeof f===j?f.call(a,{hash:{},data:b}):f),h+=k(e)+'"\n            '+k((f=c.selected||a&&a.selected,g={hash:{},data:b},f?f.call(a,a&&a["function"],(e=d&&d.collection,null==e||e===!1?e:e._kwps_logged_out_user_limit),g):l.call(a,"selected",a&&a["function"],(e=d&&d.collection,null==e||e===!1?e:e._kwps_logged_out_user_limit),g)))+" >",(f=c.label)?e=f.call(a,{hash:{},data:b}):(f=a&&a.label,e=typeof f===j?f.call(a,{hash:{},data:b}):f),h+=k(e)+"</option>\n            "
}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i="",j="function",k=this.escapeExpression,l=c.helperMissing,m=this;return i+='<div>\n    <h2>Limit entries</h2>\n\n    <div>\n        <label for="kwps_logged_in_user_limit">Logged in user</label>\n        <select id="kwps_logged_in_user_limit" name="_kwps_logged_in_user_limit" class="update-main">\n            ',h=c.each.call(b,(h=b&&b.kwpsUniquenessTypes,null==h||h===!1?h:h.logged_in),{hash:{},inverse:m.noop,fn:m.programWithDepth(1,f,e,b),data:e}),(h||0===h)&&(i+=h),i+='\n        </select>\n    </div>\n    <div>\n        <label for="kwps_logged_out_user_limit">Logged out user</label>\n        <select id="kwps_logged_out_user_limit" name="_kwps_logged_out_user_limit" class="update-main">\n            ',h=c.each.call(b,(h=b&&b.kwpsUniquenessTypes,null==h||h===!1?h:h.logged_out),{hash:{},inverse:m.noop,fn:m.programWithDepth(3,g,e,b),data:e}),(h||0===h)&&(i+=h),i+="\n        </select>\n    </div>\n</div>\n"}),this.kwps_admin_templates.table=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f="";return f}),Handlebars.registerPartial("controlTest",kwps_admin_templates.control_test),Handlebars.registerPartial("controlResults",kwps_admin_templates.control_results),Handlebars.registerPartial("manageEntries",kwps_admin_templates.manage_entries),Handlebars.registerPartial("settings",kwps_admin_templates.settings),Handlebars.registerPartial("controlTestTopRow",kwps_admin_templates.control_test_top_row),Handlebars.registerPartial("controlTestMainTitleRow",kwps_admin_templates.control_test_main_title_row),Handlebars.registerPartial("controlTestMainRow",kwps_admin_templates.control_test_main_row),Handlebars.registerPartial("controlTestQuestionTitleRow",kwps_admin_templates.control_test_question_title_row),Handlebars.registerPartial("controlTestQuestionRow",kwps_admin_templates.control_test_question_row),Handlebars.registerPartial("controlTestAnswerTitleRow",kwps_admin_templates.control_test_answer_title_row),Handlebars.registerPartial("controlTestAnswerRow",kwps_admin_templates.control_test_answer_row),Handlebars.registerHelper("t",function(a){return void 0!=kwps_translations&&void 0!=kwps_translations[a]?kwps_translations[a]:a}),Handlebars.registerHelper("debug",function(a){console.log("Current Context"),console.log("===================="),console.log(this),a&&(console.log("Value"),console.log("===================="),console.log(a))}),Handlebars.registerHelper("getColumnCount",function(a){return a=parseInt(a.length),a+2}),Handlebars.registerHelper("setIndex",function(a){this.index=Number(a+1)}),Handlebars.registerHelper("subStringStripper",function(a,b){var c=document.createElement("DIV");c.innerHTML=a;var d=c.textContent||c.innerText||"";return d.substring(0,b)+" ..."}),Handlebars.registerHelper("sorter",function(a,b){var c,d=0;for(c in b)b.hasOwnProperty(c)&&d++;var e;return e=0==a?'<span class="up passive"></span>':'<span class="up"></span>',e+=a==d-1?'<span class="down passive"></span>':'<span class="down"></span>'}),Handlebars.registerHelper("lastItem",function(a,b,c){var d,e=0;for(d in c)c.hasOwnProperty(d)&&e++;return b==e-1?a:""}),Handlebars.registerHelper("selected",function(a,b){return a===b?" selected":""}),Handlebars.registerHelper("ifCond",function(a,b,c,d){switch(b){case"==":return a==c?d.fn(this):d.inverse(this);case"===":return a===c?d.fn(this):d.inverse(this);case"<":return c>a?d.fn(this):d.inverse(this);case"<=":return c>=a?d.fn(this):d.inverse(this);case">":return a>c?d.fn(this):d.inverse(this);case">=":return a>=c?d.fn(this):d.inverse(this);case"&&":return a&&c?d.fn(this):d.inverse(this);case"||":return a||c?d.fn(this):d.inverse(this);default:return d.inverse(this)}}),Handlebars.registerHelper("ifLength",function(a,b,c){var d,e=0;for(d in a)a.hasOwnProperty(d)&&e++;return b>e||0>b?c.fn(this):c.inverse(this)}),jQuery(function(a){function b(a){for(var b=window.location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(e[0]==a)return e[1]}}a("#tabs").tabs(),a.fn.serializeObject=function(){var b={};return a.each(this.serializeArray(),function(c,d){var e=d.name,f=d.value;b[e]=void 0===b[e]?f:a.isArray(b[e])?b[e].concat(f):[b[e],f]}),b};var c={};c.url="admin-ajax.php?action=",c.openRow={kwps_outro:!0,kwps_intro:!0,kwps_question_group:!0,questionGroup:0,question:0},c.views={},c.templates={controlPanel:kwps_admin_templates.control_panel,edit:kwps_admin_templates.edit,question:kwps_admin_templates.table,newKwpsTest:kwps_admin_templates.choose_testmodus};var d=Backbone.Router.extend({routes:{"":"home","edit/:id":"edit","edit/question/:id":"editQuestion","new/:type/:parentId":"new","new":"newKwpsTest","delete/:id":"deletePostType"},home:function(){void 0!==c.kwpsPollsCollection&&(c.views.index=new c.KwpsView({collection:c.kwpsPollsCollection}),c.views.index.initialize())},edit:function(a){void 0!==c.kwpsPollsCollection&&(c.views.edit=new c.KwpsViewEdit({model:c.kwpsPollsCollection.get(a)}))},editQuestion:function(a){void 0!==c.kwpsPollsCollection&&(c.views.edit=new c.KwpsViewQuestion({model:c.kwpsPollsCollection.get(a)}))},newKwpsTest:function(){c.kwpsPollsCollection=new Backbone.Collection(kwpsTests,{model:KwpsModel}),c.views.newKwpsTest=new c.KwpsViewNewKwpsTest}});KwpsModel=Backbone.Model.extend({action:{create:"kwps_save",update:"kwps_update","delete":"kwps_delete"},sync:function(a,b,d){return d=d||{},d.url=c.url+b.action[a.toLowerCase()]+b.attributes.post_type.substring(4),Backbone.sync.apply(this,arguments)},initialize:function(){},changeHandler:function(){this.save({silent:!0},{error:function(){console.log(this)},success:function(){console.log(this)}})},destroy:function(){this.set("post_status","trash"),this.save()},idAttribute:"ID",defaults:{post_author:0,post_date:"",post_title:"",post_status:"draft",post_modified:"",post_parent:0,post_type:""}}),c.KwpsViewNewKwpsTest=Backbone.View.extend({el:"#kwps_test",initialize:function(a){this.options=a||{},_.bindAll(this,"cleanup"),this.render()},cleanup:function(){this.undelegateEvents(),a(this.el).empty()},events:{"submit form#create-new-test":"createKwpsTest"},render:function(){a(this.el).html(c.templates.newKwpsTest({kwpsTestModi:kwpsTestModi}))},createKwpsTest:function(b){b.preventDefault();var d=a(b.target).serializeObject();d.post_type="kwps_test_collection",d.post_status="draft";var e=this,f=new KwpsModel(d);f.save({},{wait:!0,success:function(a){c.kwpsPollsCollection.add(a);for(var b=0;1>b;b++)e.createVersion(a.get("ID"),b);var d=window.location.pathname+window.location.search+"&action=edit&id="+a.get("ID");window.history.pushState(a.get("ID"),"Edit",d),c.router.navigate("",{trigger:!0})}})},createVersion:function(a,b){var d=this,e=new KwpsModel({post_type:"kwps_version",post_status:"draft",post_title:"Version "+(b+1),post_parent:a,_kwps_sort_order:b});e.save({},{wait:!0,success:function(a){c.kwpsPollsCollection.add(a);for(var b=0;1>b;b++)d.createQuestionGroup(a.get("ID"),b)}})},createQuestionGroup:function(a,b){var d=this,e=new KwpsModel({post_type:"kwps_question_group",post_status:"draft",post_title:"Question Group "+(b+1),post_parent:a,_kwps_sort_order:b});e.save({},{success:function(a){c.kwpsPollsCollection.add(a);for(var b=0;1>b;b++)d.createQuestion(a.get("ID"),b,a.get("post_type"))}})},createQuestion:function(a,b,d){var e=this,f=new KwpsModel({post_type:"kwps_question",post_status:"draft",post_content:"question "+b,post_parent:a,_kwps_sort_order:b});f.save({},{success:function(a){c.kwpsPollsCollection.add(a);for(var b=0;2>b;b++)e.createAnswer(a.get("ID"),b,d)}})},createAnswer:function(a,b){var d=new KwpsModel({post_type:"kwps_answer_option",post_status:"draft",post_content:"answer "+(b+1),post_parent:a,_kwps_sort_order:b,_kwps_answer_option_value:"value..."});d.save({},{success:function(a){c.kwpsPollsCollection.add(a)}})}}),c.KwpsView=Backbone.View.extend({el:"#kwps_test",initialize:function(){this.render(),this.listenTo(this.collection,"add remove",this.render)},events:{"click .delete-version":"deleteVersion","mouseenter td":"showActions","mouseleave td":"hideActions","mouseenter th":"showActions","mouseleave th":"hideActions","click .toggle-details":"toggleDetails","click button.add":"createNew","click span.del":"deletePostType","change #post_title":"changeTitle","change .update-main":"updateTestCollection","change .update-post-title":"updatePostTitle"},cleanup:function(){this.undelegateEvents(),a(this.el).empty()},render:function(){var b=this.prepareData();a(this.el).html(c.templates.controlPanel(b)),a("#tabs").tabs()},prepareData:function(){var a={},d={};d.intro=[],d.outro=[];var e=this.collection.get(b("id"));a.title=e.get("post_title"),a.versions=this.collection.where({post_type:"kwps_version"}),d.amountOfVersions=a.versions.length,d.amountOfQuestionPages=this.collection.where({post_type:"kwps_question_group"}).length,a.collection=this.collection.findWhere({post_type:"kwps_test_collection"}).toJSON(),a.testmodus=this.collection.findWhere({ID:a.collection.post_parent}).toJSON();for(var f=0;f<a.versions.length;f++){a.versions[f]=a.versions[f].toJSON();var g=this.collection.findWhere({post_type:"kwps_intro",post_parent:a.versions[f].ID});void 0!==g&&(a.intro=!0,a.versions[f].kwpsIntro=g.toJSON(),d.intro[f]=g.toJSON());var h=this.collection.findWhere({post_type:"kwps_outro",post_parent:a.versions[f].ID});void 0!==h&&(a.outro=!0,a.versions[f].kwpsOutro=h.toJSON(),d.outro[f]=h.toJSON()),0===f&&(a.versions[f].main=!0),a.versions.length>1&&(a.versions[f].deleteVersion=!0)}for(var i=this.collection.where({post_type:"kwps_question_group"}),f=i.length-1;f>=0;f--)i[f]=i[f].toJSON();i=_.toArray(_.groupBy(i,"_kwps_sort_order"));for(var j=i.length-1;j>=0;j--)if(j==c.openRow.questionGroup){i[j].open=!0;for(var k=0;k<i[j].length;k++){for(var l=this.collection.where({post_type:"kwps_question",post_parent:i[j][k].ID}),f=l.length-1;f>=0;f--)l[f]=l[f].toJSON();l=_.groupBy(l,"_kwps_sort_order");for(var f in l)if(f==c.openRow.question){l[f].open=!0,a.answers=[];for(var m=0;m<l[f].length;m++){var n=this.collection.where({post_type:"kwps_answer_option",post_parent:l[f][m].ID});_.each(n,function(a,b){n[b]=a.toJSON()}),a.answers.push(n)}}}}if(d.questionGroupsLength=i.length,a.questionGroups=i,a.questions=l,a.answers=_.flatten(a.answers),a.answers=_.groupBy(a.answers,"_kwps_sort_order"),a.kwpsUniquenessTypes=kwpsUniquenessTypes,a.open=c.openRow,a.table=[],a.table.push({colSpan:a.versions.length+1,title:"Intro",postType:"kwps_intro",mainTitle:!0,add:this.collection.where({post_type:"kwps_intro"}).length>0?!1:!0,hasMore:this.collection.where({post_type:"kwps_intro"}).length>0?!0:!1,addText:"Add Intro",opened:c.openRow.kwps_intro,amount:d.intro.length/d.amountOfVersions}),this.collection.where({post_type:"kwps_intro"}).length>0&&d.intro.length==d.amountOfVersions&&c.openRow.kwps_intro&&a.table.push({sorterArrows:!1,postType:"kwps_intro",deletable:!0,hasMore:!1,hasAmount:!1,editable:!0,versions:d.intro,mainRow:!0,sortOrder:d.intro[d.intro.length-1]._kwps_sort_order}),a.table.push({colSpan:a.versions.length+1,title:"Question pages",postType:"kwps_question_group",mainTitle:!0,add:a.testmodus._kwps_max_question_groups<=d.amountOfQuestionPages/d.amountOfVersions?!1:!0,hasMore:d.amountOfQuestionPages/d.amountOfVersions>0?!0:!1,addText:"Add question page",opened:c.openRow.kwps_question_group,amount:d.amountOfQuestionPages/d.amountOfVersions}),d.questionGroupsLength>0&&c.openRow.kwps_question_group){for(var o in a.questionGroups)if(console.log("key",o),a.table.push({sorterArrows:a.questionGroups.length>1?!0:!1,postType:a.questionGroups[o][0].post_type,deletable:!0,hasMore:this.collection.where({post_type:"kwps_question",post_parent:a.questionGroups[o][a.questionGroups.length-1].ID}).length>0?!0:!1,hasAmount:!1,hasOpened:c.openRow.questionGroup==o?!0:!1,editable:!0,versions:a.questionGroups[o],mainRow:!0,sortOrder:a.questionGroups[o][0]._kwps_sort_order,amountOfSiblings:this.collection.where({post_type:"kwps_question",post_parent:a.questionGroups[o][a.questionGroups.length-1].ID}).length}),c.openRow.questionGroup==o){d.questions=[],a.table.push({questionTitle:!0,title:"Questions",postType:"kwps_question",addText:"Add question",colSpan:a.versions.length+1});for(var f=a.questionGroups[o].length-1;f>=0;f--)console.log(a.questionGroups[o][f].ID),d.questions=d.questions.concat(this.collection.where({post_type:"kwps_question",post_parent:a.questionGroups[o][f].ID}));console.log(d.questions);for(var f=d.questions.length-1;f>=0;f--)d.questions[f]=d.questions[f].toJSON();console.log(d.questions),d.questions=_.toArray(_.groupBy(d.questions,"_kwps_sort_order")),console.log(d.questions);for(var f=0;f<d.questions.length;f++)if(console.log(d.questions[f]),console.log(d.questions[f][0]),a.table.push({versions:d.questions[f],question:!0,postType:d.questions[f][0].post_type,sortOrder:d.questions[f][0]._kwps_sort_order,amountOfSiblings:this.collection.where({post_type:"kwps_answer_option",post_parent:d.questions[f][0].ID}).length}),f==c.openRow.question){d.answers=[],a.table.push({answerTitle:!0,title:"Answers",postType:"kwps_answer_option",addText:"Add answer",colSpan:a.versions.length+1});for(var m=d.questions[f].length-1;m>=0;m--)d.answers=d.answers.concat(this.collection.where({post_type:"kwps_answer_option",post_parent:d.questions[f][m].ID}));console.log("answers: ",d.answers);for(var m=d.answers.length-1;m>=0;m--)d.answers[m]=d.answers[m].toJSON();console.log("answers: ",d.answers),d.answers=_.toArray(_.groupBy(d.answers,"_kwps_sort_order")),console.log("answers: ",d.answers);for(var m=0;m<d.answers.length;m++)a.table.push({answer:!0})}}console.log(a.table)}return a.table.push({colSpan:a.versions.length+1,title:"Outro",postType:"kwps_outro",mainTitle:!0,add:this.collection.where({post_type:"kwps_outro"}).length>0?!1:!0,hasMore:this.collection.where({post_type:"kwps_outro"}).length>0?!0:!1,addText:"Add outro",opened:c.openRow.kwps_outro,amount:d.outro.length/d.amountOfVersions}),console.log(d.outro),this.collection.where({post_type:"kwps_outro"}).length>0&&d.outro.length==d.amountOfVersions&&c.openRow.kwps_outro&&a.table.push({sorterArrows:!1,postType:"kwps_outro",deletable:!0,hasMore:!1,hasAmount:!1,editable:!0,versions:d.outro,mainRow:!0,sortOrder:d.outro[d.outro.length-1]._kwps_sort_order}),a},deleteVersion:function(b){b.preventDefault();var c=a(b.target).data("version-id"),d=this.collection.get(c);d.destroy(),this.collection.remove(d)},deleteUnique:function(a){var b=this.collection.findWhere({post_type:a});b.destroy(),this.collection.remove(b)},deleteRow:function(a,b){console.log(a),console.log(b);for(var c=this.collection.where({post_type:a,_kwps_sort_order:b.toString()}),d=0;d<c.length;d++)c[d].destroy();this.collection.remove(c)},deletePostType:function(b){b.preventDefault();{var c=a(b.currentTarget).data("type"),d=this.collection.where({post_type:"kwps_poll"});d.length}switch(c){case"unique":var e=a(b.currentTarget).data("post-type");this.deleteUnique(e);break;case"row":var f=a(b.currentTarget).data("sort-order"),e=a(b.currentTarget).data("post-type");this.deleteRow(e,f);break;default:console.log("no post type was given")}},createNew:function(b){b.preventDefault();var c=a(b.currentTarget).data("post-type"),d=this.collection.where({post_type:"kwps_version"}),e=d.length;switch(c){case"kwps_intro":for(var f=0;e>f;f++)this.createIntro(d[f].id);break;case"kwps_outro":for(var f=0;e>f;f++)this.createOutro(d[f].id);break;case"kwps_question_group":for(var f=0;e>f;f++)this.createQuestionGroup(d[f].id);break;case"kwps_question":for(var f=0;e>f;f++){var g=this.collection.findWhere({post_type:"kwps_question_group",post_parent:d[f].id});this.createQuestion(g.get("ID"))}break;case"kwps_answer_option":for(var h=a(b.currentTarget).data("sort-order"),f=0;e>f;f++)for(var i=this.collection.where({post_type:"kwps_question_group",post_parent:d[f].id}),j=0;j<i.length;j++)for(var k=this.collection.where({post_type:"kwps_question",post_parent:i[j].id,_kwps_sort_order:h.toString()}),l=0;l<k.length;l++)this.createAnswer(k[l].id);break;case"kwps_version":this.createVersion(d[e-1],e);break;default:console.log("no post type was given")}},createVersion:function(a,b){var d=this;c.kwpsPollsCollection.create({post_type:"kwps_version",post_status:"draft",post_title:"Version "+b,post_content:"Version "+b,post_parent:a.get("post_parent"),_kwps_sort_order:b},{success:function(b){d.createIntro(b.get("ID"),!1),d.createOutro(b.get("ID"),!1);for(var c=d.collection.where({post_type:"kwps_question_group",post_parent:a.get("ID")}),e=0;e<c.length;e++){var f=c[e];d.createQuestionGroup(b.get("ID"),function(a){for(var b=d.collection.where({post_type:"kwps_question",post_parent:f.id}),c=0;c<b.length;c++){var e=b[c];d.createQuestion(a.get("ID"),function(a){for(var b=d.collection.where({post_type:"kwps_answer_option",post_parent:e.id}),c=0;c<b.length;c++)d.createAnswer(a.get("ID"),function(a){console.log("answer created: "+a.id)})})}})}}})},createIntro:function(a,b){var d=new KwpsModel({post_type:"kwps_intro",post_status:"draft",post_content:"intro ",post_parent:a,_kwps_sort_order:"0"});d.save({},{success:function(a){c.kwpsPollsCollection.add(a),b&&c.router.navigate("edit/"+a.id,{trigger:!0})}})},createOutro:function(a,b){var d=new KwpsModel({post_type:"kwps_outro",post_status:"draft",post_content:"outro ",post_parent:a,_kwps_sort_order:0});d.save({},{success:function(a){c.kwpsPollsCollection.add(a),b&&c.router.navigate("edit/"+a.id,{trigger:!0})}})},createQuestionGroup:function(a,b){var c=this.collection.where({post_type:"kwps_question_group",post_parent:a}).length;this.collection.create({post_type:"kwps_question_group",post_status:"draft",post_title:"Question Group "+c,post_parent:a,_kwps_sort_order:c},{wait:!0,success:function(a){b&&b(a)}})},createQuestion:function(a,b){var d=this.collection.where({post_type:"kwps_question",post_parent:a}).length;c.kwpsPollsCollection.create({post_type:"kwps_question",post_status:"draft",post_content:"question",post_parent:a,_kwps_sort_order:d},{wait:!0,success:function(a){b&&b(a)}})},createAnswer:function(a,b){var d=this.collection.where({post_type:"kwps_answer_option",post_parent:a}).length;c.kwpsPollsCollection.create({post_type:"kwps_answer_option",post_status:"draft",post_content:"answer ",post_parent:a,_kwps_sort_order:d,_kwps_answer_option_value:"value ..."},{wait:!0,success:function(a){b&&b(a)}})},showActions:function(b){a(b.target).find(".actions").show()},hideActions:function(b){a(b.target).find(".actions").hide()},toggleDetails:function(b){switch(type=a(b.currentTarget).data("type")){case"kwps_intro":c.openRow[type]=c.openRow[type]?!1:!0;break;case"kwps_outro":c.openRow[type]=c.openRow[type]?!1:!0;break;case"kwps_question_group":c.openRow[type]=c.openRow[type]?!1:!0}this.render()},preview:function(){},edit:function(b){var d=a(b.target).closest("div.actions").data("kwps-attribute"),e=a(b.target).closest("div.actions").data("kwps-id");"undefined"==typeof e&&new c.KwpsViewEdit({model:c.test,attribute:d})},changeTitle:function(b){this.model.set("post_title",a(b.target).val())},updateTestCollection:function(c){var d=this.collection.get(b("id")),e=a(c.target).attr("name"),f=a(c.target).val();"on"===f&&(f=1),d.set(e,f),d.save()},updatePostTitle:function(b){var c=a(b.target).attr("name"),d=a(b.target).val(),e=a(b.target).data("id"),f=this.collection.get(e);f.set(c,d),f.save()}}),c.KwpsViewEdit=Backbone.View.extend({el:"#kwps_test",initialize:function(a){this.options=a||{},_.bindAll(this,"cleanup"),this.render()},cleanup:function(){this.undelegateEvents(),a(this.el).empty()},events:{"click button#update":"updateData"},render:function(){var b={attribute:this.options.attribute,label:kwps_translations[this.options.attribute],text:this.model.get("post_content"),title:this.model.get("post_title"),answer_option_value:this.model.get("_kwps_answer_option_value")};a(this.el).html(c.templates.edit(b)),tinymce.remove(),tinymce.init({menubar:!1,visual:!0,selector:"textarea",plugins:"code link hr paste lists table textcolor wordcount charmap",toolbar:["bold italic strikethrough bullist numlist blockquote hr alignleft aligncenter alignright link unlink","formatselect underline alignjustify forecolor backcolor paste removeformat charmap outdent indent undo redo | code"]}),a("#add-media-button").on("click",function(){return tb_show("","media-upload.php?type=image&amp;TB_iframe=true"),!1}),window.send_to_editor=function(b){var c=a("img",b).attr("src"),d=url.split("/").pop();a("iframe").contents().find("#tinymce").append('<img class="img img-'+d+'" src="'+c+'" alt="">'),tb_remove()}},updateData:function(b){var c,d,e,f;b.preventDefault(),tinymce.triggerSave(),e=a(b.target).closest("form").find("textarea").val(),c=this.model.get("post_type"),"kwps_question_group"===c?d=a(b.target).closest("form").find("input[name=qg-title]").val():"kwps_answer_option"===c&&(f=a(b.target).closest("form").find("input[name=ao-value]").val(),f||(f="value...")),this.model.save({post_content:e,post_title:d,_kwps_answer_option_value:f}),this.cleanup(),window.location="#"}}),c.KwpsViewQuestion=Backbone.View.extend({el:"#kwps_test",initialize:function(a){this.options=a||{},_.bindAll(this,"cleanup"),this.render()},cleanup:function(){this.undelegateEvents(),a(this.el).empty()},events:{"click button#update":"updateData"},render:function(){var b=c.kwpsPollsCollection.where({post_type:"kwps_answer_option",post_parent:this.model.id});b=_.each(b,function(a){return a.toJSON()});var d={question:this.model.toJSON(),answers:b};a(this.el).html(c.templates.question(d)),tinymce.remove()},updateData:function(b){b.preventDefault();var c=a(b.target).closest("form").find("textarea").val();this.model.save("post_content",c),this.cleanup(),window.location="#"}}),"undefined"!=typeof kwpsTests&&(kwpsTests.push(kwpsTestModi[0]),c.kwpsPollsCollection=new Backbone.Collection(kwpsTests,{model:KwpsModel})),c.router=new d,Backbone.history.start()});