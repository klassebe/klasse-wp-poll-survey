jQuery(document).ready(function(a){var b=a("#kwps_show_grouping_form");b.prop("checked")?a(".groupingForm").show():a(".groupingForm").hide(),b.on("change",function(b){var c=b.currentTarget.checked;c?a(".groupingForm").show():a(".groupingForm").hide()});var c=a(".kwps-add-result-button").detach();a("div.wp-editor-tools").append(c),a(".kwps-add-result-button").on("click",function(){var b="",c=kwpsInfo.testCollectionOutputTypes;tb_show("",kwpsInfo.siteurl+"/wp-content/plugins/klasse-wp-poll-survey/classes/show-charts.php?type=image&amp;TB_iframe=true");var e=a.ajax({url:"admin-ajax.php?action=kwps_get_result_page",context:document.body});e.done(function(b){a("iframe").contents().find("#kwps-result-page").append(b)}),e.fail(function(){alert(kwps_translations["Errors occurred. Please check below for more information."])}),a.each(c,function(a,c){b+='<div id="'+c+'" class="media-item left"><label><h4>'+c.charAt(0).toUpperCase()+c.slice(1).split("-").join(" ")+'</h4><input type="radio" name="results" value="'+c+'"><img class="thumbnail" src="images/'+c+'.png" alt="'+c+'" height="128" width="128"></label></div>'}),kwpsInfo.version_ids.forEach(function(d){a.each(c,function(a,c){b+='<div id="'+c+'" class="media-item left versionCharts" data-id="'+d.ID+'"><label><h4>'+c.charAt(0).toUpperCase()+c.slice(1).split("-").join(" ").slice(0,-8)+d.post_title+'</h4><input type="radio" name="results" value="'+c+'"><img class="thumbnail" src="images/'+c+'.png" alt="'+c.slice(0,-8)+d.post_title+'" height="128" width="128"></label></div>'})});var f,g,h,i=setInterval(function(){d("#charts").append(b),d("input:radio").hide(),d("input:radio").on("click",function(b){d(".selected").removeClass(),a(this).next().addClass("selected"),f=a(this).val(),g=a(b.target).closest("div.versionCharts"),h=g.length?g.data("id"):null}),d("#add-result-to-editor").on("click",function(){if(f){a("#collection_outro_content_ifr").contents().find("#tinymce").append("[kwps_result "+(g.length?"level=version id="+h+" ":"")+"result="+f+"]");var b=a("#collection_outro_content"),c=b.val()+"[kwps_result "+(g.length?"level=version id="+h+" ":"")+"result="+f+"]";b.val(c),tb_remove()}else alert("Please select a result view to import")}),d("#charts").length>0&&clearInterval(i)},100);return!1});var d=function(b){return a("iframe").contents().find(b)},e=a("#publishedTextarea");if(e.length>0){var f=e.closest("div.kwps-content-editor").innerWidth(),g=20;e.val().split("\n").forEach(function(){g+=19}),e.innerWidth(f),e.innerHeight(g)}});